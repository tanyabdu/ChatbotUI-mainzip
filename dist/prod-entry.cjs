"use strict";var g=Object.create;var l=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var w=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var z=(t,e,i,p)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of v(e))!y.call(t,o)&&o!==i&&l(t,o,{get:()=>e[o],enumerable:!(p=f(e,o))||p.enumerable});return t};var s=(t,e,i)=>(i=t!=null?g(w(t)):{},z(e||!t||!t.__esModule?l(i,"default",{value:t,enumerable:!0}):i,t));var n=s(require("express"),1),d=require("http"),a=s(require("path"),1),r=(0,n.default)(),h=(0,d.createServer)(r),u=!1;r.get("/health",(t,e)=>{e.status(200).send("OK")});r.get("/__healthcheck",(t,e)=>{e.status(200).send("OK")});var m=a.default.resolve(process.cwd(),"dist","public");r.use(n.default.static(m));r.get("*",(t,e,i)=>{if(t.path.startsWith("/api"))return u?i():e.status(503).json({error:"Server starting..."});e.sendFile(a.default.join(m,"index.html"))});var c=parseInt(process.env.PORT||"5000",10);h.listen(c,"0.0.0.0",()=>{console.log(`[prod] Server listening on port ${c}`),S()});async function S(){try{console.log("[prod] Starting async app initialization...");let t=Date.now(),{initializeApp:e}=await import("./app-init.cjs");await e(h,r),u=!0;let i=Date.now()-t;console.log(`[prod] App fully initialized in ${i}ms`)}catch(t){console.error("[prod] Failed to initialize app:",t),process.exit(1)}}
